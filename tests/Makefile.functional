different-formats-maps-api: # NEX-T10392-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_different_formats_maps_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

persistence-on-page-navigate-api: # NEX-T10393-PERSISTENCE-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_persistence_on_page_navigate_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

persistence-on-restart-api: # NEX-T10393-RESTART-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_persistence_on_restart_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
additional-floor-plans-api: # NEX-T10405-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_additional_floor_plans_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

add-delete-3d-object-api: # NEX-T10428-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_add_delete_3d_object_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

upload-3d-glb-file-api: # NEX-T10425-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_upload_3d_glb_file_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

upload-only-3d-glb-files-api: # NEX-T10433-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_upload_only_3d_glb_files_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)

sensor-area-api: # NEX-T10401-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_sensor_area_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

sensor-location-api: # NEX-T10400-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_sensor_location_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

calibrate-all-sensor-types-api: # NEX-T10457-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_calibrate_all_sensor_types_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
# SPDX-FileCopyrightText: (C) 2025 Intel Corporation
# SPDX-License-Identifier: Apache-2.0

add-orphaned-cameras: # NEX-T10402
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_add_orphaned_cameras.py, 'pgserver web scene', true, /run/secrets/controller.auth)

api-large-strings: # NEX-T10583
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_api_large_strings.py, 'pgserver web scene', true, /run/secrets/controller.auth)

auto-calibration:  # NEX-T10405
	$(eval SERVICES := $(strip pgserver web queuing-video camcalibration))
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml:$(COMPOSE)/dlstreamer/queuing_video.yml:$(COMPOSE)/camcalibration.yml:$(COMPOSE)/cams.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_auto_calibration.py, '$(SERVICES)', true, /run/secrets/browser.auth,tests/calibrationdb.tar.bz2)

child-scenes: # NEX-T10439
	$(eval IMAGE_OLD := $(BASE_IMAGE))
	$(eval override BASE_IMAGE := $(IMAGE)-controller-test)
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_child_scenes.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval override BASE_IMAGE := $(IMAGE_OLD))

camera-deletion-api: # NEX-T10403-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_camera_deletion_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

camera-intrinsics-api: # NEX-T10415-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_camera_intrinsics_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

delete-roi-mqtt: # NEX-T10430
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_delete_roi_mqtt.py, 'pgserver scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

delete-sensor-mqtt: # NEX-T10432
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_delete_sensor_mqtt.py, 'pgserver scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

delete-sensor-scene-api: # NEX-T10397-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_delete_sensor_scene_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

delete-sensors-api: # NEX-T10399-API
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_delete_sensors_api.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

delete-tripwire-mqtt: # NEX-T10431
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/ui/tc_delete_tripwire_mqtt.py, 'pgserver scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

geospatial-ingest-publish: # NEX-T10490
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_geospatial_ingest_publish.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

mqtt-auth: # NEX-T10423
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/security/system/negative_mqtt_insecure_auth.py)

mqtt-cert: # NEX-T10423
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/security/system/negative_mqtt_insecure_cert.py)

mqtt-roi: # NEX-T10404
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_roi_mqtt.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

mqtt-sensor-roi: # NEX-T10460
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_mqtt_sensor_roi.py, 'pgserver web scene', true, /run/secrets/controller.auth)

mqtt-slow-sensor-roi: # NEX-T10461
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_mqtt_slow_sensor_roi.py, 'pgserver web scene', true, /run/secrets/controller.auth)

mqtt-tripwire: # NEX-T10406
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_tripwire_mqtt.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

out-of-box: # NEX-T10417
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/dlstreamer/retail_video.yml:$(COMPOSE)/dlstreamer/queuing_video.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web_default.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/cams.yml)
	$(eval SERVICES := $(strip pgserver web queuing-video retail-video scene))
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/ui/tc_out_of_box.py, '$(SERVICES)', true, /run/secrets/browser.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))


out-of-box-no-ntp: # NEX-T10417
	$(eval SERVICES := $(strip pgserver web queuing-video retail-video scene))
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/dlstreamer/retail_video_no_ntp.yml:$(COMPOSE)/dlstreamer/queuing_video_no_ntp.yml:$(COMPOSE)/scene_no_ntp.yml:$(COMPOSE)/web_default.yml:$(COMPOSE)/cams.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/ui/tc_out_of_box.py, '$(SERVICES)', true, /run/secrets/browser.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

orphaned-sensor: # NEX-T10398
	$(call set-prefix)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_orphaned_sensor.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

reid-performance-degradation: # NEX-T10541
	$(eval IMAGE_OLD := $(BASE_IMAGE))
	$(eval override BASE_IMAGE := $(IMAGE)-controller-test)
	$(eval SERVICES := $(strip pgserver web queuing-video retail-video scene))
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/vdms.yml:$(COMPOSE)/dlstreamer/retail_video_reid.yml:$(COMPOSE)/dlstreamer/queuing_video_reid.yml:$(COMPOSE)/scene_reid.yml:$(COMPOSE)/web.yml)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_reid_performance_degradation.py, '$(SERVICES)', true)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))
	$(eval override BASE_IMAGE := $(IMAGE_OLD))

reid-unique-count: # NEX-T10539
	$(eval SERVICES := $(strip pgserver web queuing-video retail-video scene))
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/vdms.yml:$(COMPOSE)/dlstreamer/retail_video_reid.yml:$(COMPOSE)/dlstreamer/queuing_video_reid.yml:$(COMPOSE)/scene_reid.yml:$(COMPOSE)/web.yml:$(COMPOSE)/cams.yml)
	$(eval override IMAGE_OLD := $(BASE_IMAGE))
	$(eval BASE_IMAGE := $(IMAGE)-controller-test)
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_reid_unique_count.py, '$(SERVICES)', true)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))
	$(eval override BASE_IMAGE := $(IMAGE_OLD))

rest-test: # NEX-T10464
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_rest_test.py, 'pgserver web', true, /run/secrets/controller.auth)

scene-import:
	$(call common-recipe,\
	$(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/dlstreamer/retail_video.yml:$(COMPOSE)/cams.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml,\
	tests/ui/tc_scene_import.py,\
	'pgserver web retail-video scene',\
	true,\
	/run/secrets/controller.auth,\
	)

sensors-send-events: # NEX-T10456
	$(eval OLDSECRETSDIR := $(SECRETSDIR))
	$(eval SECRETSDIR := $(PWD)/manager/secrets)
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/ntp.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_sensors_send_mqtt_messages.py, 'pgserver web scene', true, /run/secrets/controller.auth)
	$(eval SECRETSDIR := $(OLDSECRETSDIR))

vdms-similarity-search: # NEX-T10516
	$(eval override IMAGE_OLD := $(BASE_IMAGE))
	$(eval override BASE_IMAGE := $(IMAGE)-controller-test)
	$(call common-recipe, $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/vdms.yml:$(COMPOSE)/pgserver.yml, tests/functional/tc_vdms_similarity_search.py,'pgserver',true, /run/secrets/controller.auth)
	$(eval override BASE_IMAGE := $(IMAGE_OLD))

dlstreamer-api: # NEX-T12678
	$(eval SERVICES := $(strip pgserver web queuing-video retail-video scene))
	$(eval COMPOSE_FILES := $(COMPOSE)/dlstreamer/broker.yml:$(COMPOSE)/pgserver.yml:$(COMPOSE)/dlstreamer/retail_video.yml:$(COMPOSE)/dlstreamer/queuing_video.yml:$(COMPOSE)/scene.yml:$(COMPOSE)/web.yml:$(COMPOSE)/cams.yml)
	$(call common-recipe, $(COMPOSE_FILES), tests/functional/tc_dlstreamer_api.py, '$(SERVICES)', true, /run/secrets/browser.auth)
